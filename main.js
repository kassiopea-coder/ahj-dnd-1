!function(){var e={177:function(){}},t={};function s(a){var i=t[a];if(void 0!==i)return i.exports;var r=t[a]={exports:{}};return e[a](r,r.exports,s),r.exports}!function(){"use strict";s(177);const e=new class{constructor(e){this.taskmanager=e,this.columns=e.querySelectorAll(".taskmanager__list"),this.add=e.querySelectorAll(".taskmanager__add"),this.tasks=[["Lorem ipsum dolor sit amet, consectetur adipiscing elit.","Suspendisse pellentesque ex ornare felis placerat fringilla.","Ut imperdiet, risus at vestibulum fermentum","Donec vel purus blandit nisi rhoncus semper in sed sem.","Morbi fermentum ex sed lectus finibus"],["Duis tincidunt consequat dolor","Nam eleifend hendrerit lorem.","Vestibulum augue odio"],["Phasellus eget pulvinar dolor.","Sed et enim non nibh volutpat imperdiet."]],this.addItem=this.addItem.bind(this),this.addItemSubmit=this.addItemSubmit.bind(this),this.addItemClose=this.addItemClose.bind(this),this.closeItemMouseOver=this.closeItemMouseOver.bind(this),this.closeItemMouseOut=this.closeItemMouseOut.bind(this),this.closeItem=this.closeItem.bind(this),this.loadTasks=this.loadTasks.bind(this),this.saveTasks=this.saveTasks.bind(this),this.dragStart=this.dragStart.bind(this),this.dragMove=this.dragMove.bind(this),this.dragFinish=this.dragFinish.bind(this),this.dragTakePlace=this.dragTakePlace.bind(this),this.dragPlaceRemove=this.dragPlaceRemove.bind(this)}init(){document.addEventListener("DOMContentLoaded",this.loadTasks),window.addEventListener("beforeunload",this.saveTasks),this.render(),[...this.add].forEach((e=>{e.addEventListener("click",this.addItem)})),[...this.columns].forEach((e=>{e.addEventListener("mouseover",this.closeItemMouseOver)})),[...this.columns].forEach((e=>{e.addEventListener("mouseout",this.closeItemMouseOut)})),[...this.columns].forEach((e=>{e.addEventListener("mousedown",this.dragStart)}))}render(){for(const e of this.columns)e.innerHTML="";if(this.tasks.length)for(let e=0;e<this.columns.length;e+=1)this.tasks[e].forEach((t=>{const s=document.createElement("li");s.classList.add("taskmanager__item"),s.innerText=t,this.columns[e].append(s)}))}addItem(e){const t=document.createElement("form");t.classList.add("taskmanager__add_form"),t.innerHTML='\n    <textarea class="taskmanager__add_textarea" placeholder="Введите текст..."></textarea>\n    <div class="taskmanager__add_controls">\n      <button class="taskmanager__add_button">Добавить</button>\n      <div class="taskmanager__add_close">✕</div>\n    </div>',e.target.replaceWith(t),t.addEventListener("submit",this.addItemSubmit),t.querySelector(".taskmanager__add_close").addEventListener("click",this.addItemClose)}addItemSubmit(e){e.preventDefault();const t=e.target.querySelector(".taskmanager__add_textarea");if(t.value){const s=e.target.parentElement.querySelector(".taskmanager__list"),a=[...this.columns].findIndex((e=>e===s));this.tasks[a].push(t.value),this.render(),e.target.replaceWith(this.add[a])}else{const e=document.createElement("div");e.classList.add("taskmanager__add_error"),e.innerText="Вы ничего не написали",t.after(e),e.style.top=t.offsetTop+t.offsetHeight-e.offsetHeight+"px",setTimeout((()=>e.remove()),2e3)}}addItemClose(e){const t=e.target.closest(".taskmanager__column").querySelector(".taskmanager__list"),s=[...this.columns].findIndex((e=>e===t));e.target.closest(".taskmanager__add_form").replaceWith(this.add[s])}closeItemMouseOver(e){if(!e.target.classList.contains("taskmanager__item"))return;if(e.relatedTarget&&e.relatedTarget.parentNode===e.target)return;if(this.draggedElement)return;const t=document.createElement("div");t.classList.add("taskmanager__close"),e.target.append(t);const s=e.target.getBoundingClientRect();t.style.top=`${window.scrollY+s.top}px`,t.style.left=window.scrollX+s.left+e.target.offsetWidth-t.offsetWidth+"px",t.addEventListener("click",this.closeItem)}closeItemMouseOut(e){if(e.relatedTarget.parentNode===e.target)return;const t=e.target.querySelector(".taskmanager__close"),s=e.target.parentNode.querySelector(".taskmanager__close");t?t.remove():s&&s.remove()}closeItem(e){const t=e.target.closest(".taskmanager__item").innerText,s=e.target.closest(".taskmanager__column").querySelector(".taskmanager__list"),a=[...this.columns].findIndex((e=>e===s)),i=this.tasks[a].findIndex((e=>e===t));this.tasks[a].splice(i,1),this.render()}loadTasks(){const e=localStorage.getItem("taskmanager");e&&(this.tasks=JSON.parse(e)),this.render()}saveTasks(){localStorage.setItem("taskmanager",JSON.stringify(this.tasks))}dragStart(e){e.target.classList.contains("taskmanager__item")&&1===e.which&&(this.targetElement=e.target,this.draggedElement=this.targetElement.cloneNode(!0),this.draggedElement.classList.add("taskmanager__dragged"),this.draggedElement.querySelector(".taskmanager__close").remove(),document.body.append(this.draggedElement),this.draggedX=e.pageX-this.targetElement.getBoundingClientRect().x,this.draggedY=e.pageY-this.targetElement.getBoundingClientRect().y,this.draggedElement.style.width=`${this.targetElement.offsetWidth}px`,this.draggedElement.style.height=`${this.targetElement.offsetHeight}px`,this.draggedElement.style.left=e.pageX-this.draggedX-5+"px",this.draggedElement.style.top=e.pageY-this.draggedY-5+"px",this.targetElement.style.display="none",document.addEventListener("mousemove",this.dragMove),[...this.columns].forEach((e=>{e.addEventListener("mousemove",this.dragTakePlace)})),[...this.columns].forEach((e=>{e.addEventListener("mouseleave",this.dragPlaceRemove)})),document.addEventListener("mouseup",this.dragFinish))}dragMove(e){e.preventDefault(),this.draggedElement&&(this.draggedElement.style.left=e.pageX-this.draggedX-5+"px",this.draggedElement.style.top=e.pageY-this.draggedY-5+"px")}dragTakePlace(e){if(!this.draggedElement)return;const t=e.target.closest(".taskmanager__list"),s=t.querySelectorAll(".taskmanager__item"),a=[t.getBoundingClientRect().top];for(const e of s)a.push(e.getBoundingClientRect().top+e.offsetHeight/2);this.targetPlace||(this.targetPlace=document.createElement("div"),this.targetPlace.classList.add("taskmanager__targetplace"),this.targetPlace.style.width=`${this.draggedElement.offsetWidth}px`,this.targetPlace.style.height=`${this.draggedElement.offsetHeight}px`);const i=a.findIndex((t=>t>e.pageY));-1!==i?s[i-1].before(this.targetPlace):t.append(this.targetPlace)}dragPlaceRemove(){this.draggedElement&&this.targetPlace&&(this.targetPlace.remove(),this.targetPlace=null)}dragFinish(e){this.draggedElement&&(e.target.closest(".taskmanager__list")?(this.targetPlace.replaceWith(this.targetElement),this.dragClean(),this.tasksCollect()):this.dragClean())}dragClean(){this.targetElement.style.display="list-item",this.draggedElement.remove(),this.draggedElement=null,this.draggedX=null,this.draggedY=null,this.targetPlace=null,document.removeEventListener("mousemove",this.dragMove),[...this.columns].forEach((e=>{e.removeEventListener("mousemove",this.dragTakePlace)})),[...this.columns].forEach((e=>{e.removeEventListener("mouseleave",this.dragPlaceRemove)})),document.removeEventListener("mouseup",this.dragFinish)}tasksCollect(){this.tasks=[[],[],[]];for(let e=0;e<this.columns.length;e+=1){const t=this.columns[e].querySelectorAll(".taskmanager__item");for(const s of t)this.tasks[e].push(s.innerText)}}}(document.querySelector(".taskmanager"));e.init(),e.tasks=[["Lorem ipsum dolor sit amet, consectetur adipiscing elit.","Suspendisse pellentesque ex ornare felis placerat fringilla.","Ut imperdiet, risus at vestibulum fermentum","Donec vel purus blandit nisi rhoncus semper in sed sem.","Morbi fermentum ex sed lectus finibus"],["Duis tincidunt consequat dolor","Nam eleifend hendrerit lorem.","Vestibulum augue odio"],["Phasellus eget pulvinar dolor.","Sed et enim non nibh volutpat imperdiet."]],e.render()}()}();